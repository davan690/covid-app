{"ast":null,"code":"var _jsxFileName = \"/Users/khoa/Dropbox/Websites/covid19/covid-app/client/src/components/Model.js\";\nimport React, { Component } from 'react';\nimport { Row, Col } from 'react-bootstrap';\nimport Input from './Input';\nimport Output from './Output';\nexport default class Model extends Component {\n  constructor(props) {\n    super(props);\n\n    this.updateMeasureWeeks = measureWeeks => {\n      this.setState({\n        measureWeeks: measureWeeks\n      });\n      this.updateData();\n    };\n\n    this.updateModelParams = modelParams => {\n      this.setState({\n        modelParams: modelParams\n      });\n      this.updateData();\n    };\n\n    this.updateR0Params = r0_params => {\n      this.setState({\n        r0_params: r0_params\n      });\n      this.updateData();\n    };\n\n    this.updateHospBeds = hospBeds => {\n      this.setState({\n        hospBeds: hospBeds\n      });\n      this.updateData();\n    };\n\n    this.updateICUBeds = ICUBeds => {\n      this.setState({\n        ICUBeds: ICUBeds\n      });\n      this.updateData();\n    };\n\n    this.updateVentilators = ventilators => {\n      this.setState({\n        ventilators: ventilators\n      });\n      this.updateData();\n    };\n\n    this.updateData = () => {\n      const {\n        measureWeeks,\n        modelParams,\n        r0_params,\n        hospBeds,\n        ICUBeds,\n        ventilators\n      } = this.state;\n      var url = \"http://localhost:9000\";\n      url += \"?int_len=\" + measureWeeks;\n      url += \"&model_vals=\" + modelParams;\n      url += \"&r0=\" + r0_params;\n      url += \"&resource_vals=\" + hospBeds + \",\" + ICUBeds + \",\" + ventilators;\n      url += \"&state=vic\";\n      fetch(url).then(res => res.json()).then(json => {\n        json = JSON.parse(json);\n        this.setState({\n          model_results: json.results,\n          newly_infected: json.data.newly_infected,\n          dates: json.data.dates\n        });\n        var axis = this.output.current.chartComponent.current.chartComponent.current.chart.axes[1];\n        axis.plotLinesAndBands.forEach(function (lineOrBand) {\n          for (var prop in axis.ticks) {\n            var tick = axis.ticks[prop];\n\n            if (Number(lineOrBand.options.value) === tick.pos) {\n              tick.gridLine.element.style.display = 'none';\n            }\n          }\n        });\n      }).catch(err => err);\n    };\n\n    this.state = {\n      // Model inputs\n      // Intervention lengths\n      measureWeeks: [0, 26, 0, 0, 0],\n      // Model Parameters\n      modelParams: ['6.66', '2.0', '50', '1.0', '0.97', '1.66', '100', '100'],\n      // Intervention Parameters\n      r0_params: ['2.67', '1.68', '1.40', '1.05', '0.32'],\n      // Resource Availability\n      // Hospital Beds\n      hospBeds: ['23187', '40', '80'],\n      // ICU Beds\n      ICUBeds: ['476', '40', '80'],\n      // Ventilators\n      ventilators: ['358', '40', '80', '300'],\n      // Model outputs\n      model_results: {},\n      newly_infected: [],\n      dates: []\n    };\n    this.output = React.createRef();\n  }\n\n  componentDidMount() {\n    this.updateData();\n  }\n\n  render() {\n    const {\n      measureWeeks,\n      modelParams,\n      r0_params,\n      hospBeds,\n      ICUBeds,\n      ventilators,\n      model_results,\n      newly_infected,\n      dates\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      style: {\n        width: \"100%\",\n        margin: 0\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      xs: 3,\n      style: {\n        paddingRight: 0\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Input border-right border-gray\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Input, {\n      params: {\n        measureWeeks: measureWeeks,\n        modelParams: modelParams,\n        r0_params: r0_params,\n        hospBeds: hospBeds,\n        ICUBeds: ICUBeds,\n        ventilators: ventilators\n      },\n      eventHandlers: {\n        updateMeasureWeeks: this.updateMeasureWeeks,\n        updateModelParams: this.updateModelParams,\n        updateR0Params: this.updateR0Params,\n        updateHospBeds: this.updateHospBeds,\n        updateICUBeds: this.updateICUBeds,\n        updateVentilators: this.updateVentilators\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 25\n      }\n    }))), /*#__PURE__*/React.createElement(Col, {\n      xs: 9,\n      style: {\n        backgroundColor: '#fefefa',\n        paddingLeft: 0\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Output, {\n      results: model_results,\n      measureWeeks: measureWeeks,\n      resources: {\n        numHospBeds: hospBeds[0],\n        numICUBeds: ICUBeds[0],\n        numVents: ventilators[1]\n      },\n      dates: dates,\n      newly_infected: newly_infected,\n      ref: this.output,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 21\n      }\n    }))));\n  }\n\n}","map":{"version":3,"sources":["/Users/khoa/Dropbox/Websites/covid19/covid-app/client/src/components/Model.js"],"names":["React","Component","Row","Col","Input","Output","Model","constructor","props","updateMeasureWeeks","measureWeeks","setState","updateData","updateModelParams","modelParams","updateR0Params","r0_params","updateHospBeds","hospBeds","updateICUBeds","ICUBeds","updateVentilators","ventilators","state","url","fetch","then","res","json","JSON","parse","model_results","results","newly_infected","data","dates","axis","output","current","chartComponent","chart","axes","plotLinesAndBands","forEach","lineOrBand","prop","ticks","tick","Number","options","value","pos","gridLine","element","style","display","catch","err","createRef","componentDidMount","render","width","margin","paddingRight","backgroundColor","paddingLeft","numHospBeds","numICUBeds","numVents"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Row, Col } from 'react-bootstrap';\n\nimport Input from './Input';\nimport Output from './Output';\n\nexport default class Model extends Component {\n    constructor(props) {\n        super(props);\n        this.state = { \n            // Model inputs\n            // Intervention lengths\n            measureWeeks:               [0, 26, 0, 0, 0],\n            \n            // Model Parameters\n            modelParams:                ['6.66', '2.0', '50', '1.0', '0.97', '1.66', '100', '100'],\n\n            // Intervention Parameters\n            r0_params:                  ['2.67', '1.68', '1.40', '1.05', '0.32'],\n\n            // Resource Availability\n            // Hospital Beds\n            hospBeds:                   ['23187', '40', '80'],\n            // ICU Beds\n            ICUBeds:                    ['476', '40', '80'],\n            // Ventilators\n            ventilators:                ['358', '40', '80', '300'],\n\n            // Model outputs\n            model_results: {},\n            newly_infected: [],\n            dates: []\n        };\n        this.output = React.createRef();\n    }\n\n    updateMeasureWeeks = (measureWeeks) => {\n        this.setState({ measureWeeks: measureWeeks });\n        this.updateData();\n    }\n\n    updateModelParams = (modelParams) => {\n        this.setState({ modelParams: modelParams });\n        this.updateData();\n    }\n\n    updateR0Params = (r0_params) => {\n        this.setState({ r0_params: r0_params });\n        this.updateData();\n    }\n    \n    updateHospBeds = (hospBeds) => {\n        this.setState({ hospBeds: hospBeds });\n        this.updateData();\n    }\n\n    updateICUBeds = (ICUBeds) => {\n        this.setState({ ICUBeds: ICUBeds });\n        this.updateData();\n    }\n\n    updateVentilators = (ventilators) => {\n        this.setState({ ventilators: ventilators });\n        this.updateData();\n    }\n\n    updateData = () => {\n        const { measureWeeks, modelParams, r0_params, hospBeds, ICUBeds, ventilators } = this.state;\n        var url = \"http://localhost:9000\";\n        url += \"?int_len=\" + measureWeeks;\n        url += \"&model_vals=\" + modelParams;\n        url += \"&r0=\" + r0_params;\n        url += \"&resource_vals=\" + hospBeds + \",\" + ICUBeds + \",\" + ventilators;\n        url += \"&state=vic\";\n        fetch(url)\n            .then(res => res.json())\n            .then(json => {\n                json = JSON.parse(json);\n                this.setState({ \n                    model_results: json.results, \n                    newly_infected: json.data.newly_infected,\n                    dates: json.data.dates\n                });\n                var axis = this.output.current.chartComponent.current.chartComponent.current.chart.axes[1];\n                axis.plotLinesAndBands.forEach(function(lineOrBand) {\n                    for (var prop in axis.ticks) {\n                        var tick = axis.ticks[prop];\n                        if (Number(lineOrBand.options.value) === tick.pos) {\n                            tick.gridLine.element.style.display = 'none';\n                        }\n                    }\n                });\n            })\n            .catch(err => err);\n    }\n\n    componentDidMount() {\n        this.updateData();\n    }\n\n    render() {\n        const { measureWeeks, modelParams, r0_params, hospBeds, ICUBeds, ventilators, model_results, newly_infected, dates } = this.state;\n        return (\n        <div>\n            <Row style={{ width: \"100%\", margin: 0 }}>\n                <Col xs={3} style={{ paddingRight: 0 }}>\n                    <div className=\"Input border-right border-gray\">\n                        <Input\n                            params = {{\n                                measureWeeks: measureWeeks, \n                                modelParams: modelParams, \n                                r0_params: r0_params, \n                                hospBeds: hospBeds, \n                                ICUBeds: ICUBeds, \n                                ventilators: ventilators\n                            }}\n                            eventHandlers={{\n                                updateMeasureWeeks: this.updateMeasureWeeks,\n                                updateModelParams: this.updateModelParams,\n                                updateR0Params: this.updateR0Params,\n                                updateHospBeds: this.updateHospBeds,\n                                updateICUBeds: this.updateICUBeds,\n                                updateVentilators: this.updateVentilators\n                            }}/>\n                    </div>\n                </Col>\n                <Col xs={9} style={{ backgroundColor: '#fefefa', paddingLeft: 0 }}>\n                    <Output \n                        results={model_results}\n                        measureWeeks={measureWeeks}\n                        resources={{\n                            numHospBeds: hospBeds[0],\n                            numICUBeds:  ICUBeds[0],\n                            numVents:    ventilators[1]\n                        }}\n                        dates={dates}\n                        newly_infected={newly_infected}\n                        ref={this.output}/>\n                </Col>\n            </Row>\n        </div>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}